<div class="container-fluid container-xxl">
  @if (scout) {
    <div class="d-flex justify-content-between gap-2 overflow-hidden">
      <div class="d-flex flex-column flex-grow-1 justify-content-start">
        <div class="mb-2">
          <span class="fs-4" style="font-family: Trueno-Black, sans-serif;">
            <i class="fa fa-arrow-left fs-5 cursor-pointer" (click)="location.back()"></i>
            {{ scoutPersonalData.name }} {{ scoutPersonalData.surname }}
            @if (scoutPersonalData.feltName) {
              ({{ scoutPersonalData.feltName }})
            }
          </span>
        </div>
        <div class="d-none d-sm-flex row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-xl-4">
          <div class="d-flex flex-row flex-sm-column flex-wrap gap-2 justify-content-between overflow-ellipsis">
            <div class="text-nowrap overflow-ellipsis mw-100">
              @if (scoutPersonalData.idDocument) {
                <b>{{ scoutPersonalData.idDocument.idType }}:</b> {{ scoutPersonalData.idDocument.number || '-' }}
              } @else {
                <b>DNI:</b> -
              }
            </div>
            <div class="text-nowrap overflow-ellipsis mw-100" [title]="scout.scoutInfo?.census || '-'">
              <b>CENSO:</b> {{ scout.scoutInfo?.census | census }}
            </div>
          </div>
          <div class="d-none d-md-flex flex-column justify-content-between">
            <div class="text-nowrap overflow-ellipsis mw-100">
              <b>RAMA:</b> {{ scout.scoutInfo?.group?.name || '-' }}
            </div>
            <div class="text-nowrap overflow-ellipsis mw-100">
              <b>UNIDAD:</b> {{ scout.scoutInfo?.group?.name || '-' }}
            </div>
          </div>
          <div class="d-none d-sm-flex flex-column justify-content-between">
            <div class="text-nowrap overflow-ellipsis mw-100">
              <b>GÉNERO:</b> {{ scoutPersonalData.gender }}
            </div>
            <div class="text-nowrap overflow-ellipsis mw-100">
              <b>EDAD:</b> {{ scoutPersonalData.birthday | age:false }}
            </div>
          </div>
          <div class="d-none d-xl-flex flex-column gap-2 align-items-start flex-shrink-1 justify-content-between">
            <div>
              <p-tag
                styleClass="py-0 px-1"
                [value]="scout.scoutInfo?.active ? 'ALTA' : 'BAJA'"
                [severity]="scout.scoutInfo?.active ? 'success' : 'danger'"
              />
            </div>
            <div>
              <p-tag
                styleClass="py-0 px-1"
                [value]="scout.scoutInfo?.federated ? 'FEDERADA' : 'NO FEDERADA'"
                [severity]="scout.scoutInfo?.federated ? 'info' : 'warn'"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="border p-1 h-100 rounded-5 d-none d-sm-block ms-3">
        <img
          class="object-fit-cover"
          style="min-width: 120px; min-height: 100px; max-height: 120px;" src="/assets/scout-user.png"
          alt="Scout"
        >
        </div>
      </div>
    <p-tabs scrollable [value]="selectedTab" (valueChange)="updateQueryParam($event)" class="main-info-panel">
      <p-tablist>
        <p-tab [value]="0" [disabled]="editing">Datos Personales</p-tab>
        <p-tab [value]="1" [disabled]="editing">Datos de Salud</p-tab>
        <p-tab [value]="2" [disabled]="editing">Datos Familiares</p-tab>
        <p-tab [value]="3" [disabled]="editing">Datos Formativos</p-tab>
        <p-tab [value]="4" [disabled]="editing">Datos Asociativos</p-tab>
        <p-tab [value]="5" [disabled]="editing">Historial Scout</p-tab>
        <p-tab [value]="6" [disabled]="editing">Datos económicos</p-tab>
        <p-tab [value]="7" [disabled]="editing">Otros Datos</p-tab>
      </p-tablist>
      <p-tabpanels>
        <div class="position-relative px-3">
          @if (!editing) {
            <p-button
              [icon]="editing ? 'pi pi-times' : 'pi pi-pencil'"
              [severity]="editing ? 'danger' : 'primary'"
              rounded
              outlined
              class="position-absolute end-0"
              size="small"
              (onClick)="editing = !editing"
            ></p-button>
          }
          <p-tabpanel [value]="0">
            @if (editing) {
              <app-personal-data-form
                [initialData]="scout"
                (onEditionStop)="onEditionStop($event)"
              />
            } @else {
              <app-personal-data [scout]="scout"/>
            }
          </p-tabpanel>
          <p-tabpanel [value]="1">
            @if (editing) {
              <app-medical-data-form
                [initialData]="scout"
                (onEditionStop)="onEditionStop($event)"
              />
            } @else {
              <app-medical-data [scout]="scout"/>
            }
          </p-tabpanel>
          <p-tabpanel [value]="2">
            @if (editing) {
              <app-contact-data-form
                [initialData]="scout"
                (onEditionStop)="onEditionStop($event)"
              />
            } @else {
              <app-contact-data [contactList]="scout.contactList"/>
            }
          </p-tabpanel>
          <p-tabpanel [value]="4">
            @if (editing) {
              <app-group-data-form
                [initialData]="scout"
                (onEditionStop)="onEditionStop($event)"
              />
            } @else {
              <app-group-data [scout]="scout"/>
            }
          </p-tabpanel>
          <p-tabpanel [value]="6">
            @if (editing) {
              <app-economic-data-form
                [initialData]="scout"
                (onEditionStop)="onEditionStop($event)"
              />
            } @else {
              <app-economic-data [scout]="scout"/>
            }
          </p-tabpanel>
        </div>
      </p-tabpanels>
    </p-tabs>
  } @else {
    <app-basic-loading-info/>
  }</div>
